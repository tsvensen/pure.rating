// pure.rating : v.0.1 : Author & copyright (c) 2012: Tim Svensen : Dual MIT & GPL license
(function(b){b.fn.rating=function(a){var a=b.extend({},b.fn.rating.defaults,a),c=" "+a.containerClasses,d=a.resetBtnOpts,f=a.resetTitle,g=d&&b('<a class="rating-btn-reset" title="'+f+'" />');b.fn.rating.opts=a;return this.each(function(){var a,f,e;if("select-one"!==this.type)return!1;e=b(this);if(e.hasClass("rating-processed"))return!1;e.css("display","none").addClass("rating-processed");a=b('<div class="rating-container'+c+'" />');"left"===d&&a.append(g.clone());e.find("option").each(function(){var c;this.value&&(c=b(this).text(),a.append(b('<a class="rating-item" title="'+c+'" />').prop("ratingvalue",this.value)))});"right"===d&&a.append(g.clone());f=e.find("option:selected").val();e.prop("rating",f);e.after(a)})};b(document).on({mouseenter:function(a){f(a)},mouseleave:function(a){f(a)},click:function(a){var a=b(a.target),c=a.parents(".rating-container").prev(),d=a.prop("ratingvalue");a.hasClass("rating-btn-reset")?(d=b.fn.rating.opts.resetVal,a.siblings().removeClass("rating-filled"),g(a,c,d)):c.prop("rating")!==d&&(a.prevAll().andSelf().not(".rating-btn-reset").addClass("rating-filled"),a.nextAll().not(".rating-btn-reset").removeClass("rating-filled"),g(a,c,d))}},".rating-item, .rating-btn-reset");var f=function(a){var c=b(a.target),a="mouseenter"===a.type?"addClass":"removeClass";c.hasClass("rating-btn-reset")||(c=c.prevAll().andSelf().not(".rating-btn-reset"));c[a]("rating-hovered")},g=function(a,c,b){a.trigger("ratingchange",{rating:b});c.prop("rating",b).find("option:selected").removeAttr("selected").end().find('option[value="'+b+'"]').attr("selected","selected").end().trigger("change")};b.fn.rating.defaults={containerClasses:"",resetBtnOpts:"left",resetVal:"",resetTitle:"Reset",initialRating:0}})(jQuery);
